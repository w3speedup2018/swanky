<style>
.currency-switcher li{float:left;position:relative}.currency-switcher{margin:0;display:inline;background:#fff;color:#000;padding:2px 5px;z-index:9999999}.currency-switcher > div{padding:2px 18px 0 0;height:20px;line-height:20px;border:0;position:relative;cursor:pointer;display:inline-block}.currency-switcher > div:after{border-bottom:2px solid #999;border-right:2px solid #999;content:"";display:block;height:5px;box-sizing:content-box;pointer-events:none;position:absolute;right:4px;top:6px;-webkit-transform-origin:66% 66%;transform-origin:66% 66%;-webkit-transform:rotate(45deg);transform:rotate(45deg);transition:all 0.15s ease-in-out;width:5px;border-color:#000}.currency-switcher.open > div:after{-webkit-transform:rotate(-135deg);transform:rotate(-135deg)}.currency-switcher .flag{top:auto !important;left:auto !important;display:inline-block;position:relative;width:16px;height:11px;background:url("https://cdn.shopify.com/s/files/1/0211/4148/7680/t/17/assets/flags.png") no-repeat}.flag.flag-gu{background-position:-96px -55px}.flag.flag-mn{background-position:-208px -88px}.flag.flag-va{background-position:-48px -154px}.flag.flag-tibet{background-position:-32px -143px}.flag.flag-fo{background-position:-64px -44px}.flag.flag-th{background-position:-16px -143px}.flag.flag-tr{background-position:-144px -143px}.flag.flag-tl{background-position:-80px -143px}.flag.flag-kz{background-position:-144px -77px}.flag.flag-zm{background-position:-16px -165px}.flag.flag-uz{background-position:-32px -154px}.flag.flag-dk{background-position:-64px -33px}.flag.flag-scotland{background-position:-176px -121px}.flag.flag-gi{background-position:-224px -44px}.flag.flag-gy{background-position:-128px -55px}.flag.flag-bj{background-position:-112px -11px}.flag.flag-fr{background-position:-80px -44px}.flag.flag-mo{background-position:-224px -88px}.flag.flag-ir{background-position:-112px -66px}.flag.flag-io{background-position:-80px -66px}.flag.flag-tm{background-position:-96px -143px}.flag.flag-ch{background-position:-96px -22px}.flag.flag-mt{background-position:-32px -99px}.flag.flag-nl{background-position:-240px -99px}.flag.flag-gp{background-position:-16px -55px}.flag.flag-im{background-position:-48px -66px}.flag.flag-tv{background-position:-176px -143px}.flag.flag-mu{background-position:-48px -99px}.flag.flag-pe{background-position:-96px -110px}.flag.flag-vi{background-position:-112px -154px}.flag.flag-hn{background-position:-176px -55px}.flag.flag-ss{background-position:-128px -132px}.flag.flag-ae{background-position:-16px 0}.flag.flag-td{background-position:-240px -132px}.flag.flag-pw{background-position:0 -121px}.flag.flag-nu{background-position:-32px -110px}.flag.flag-bt{background-position:-208px -11px}.flag.flag-ms{background-position:-16px -99px}.flag.flag-cv{background-position:-240px -22px}.flag.flag-es{background-position:-224px -33px}.flag.flag-mh{background-position:-144px -88px}.flag.flag-la{background-position:-160px -77px}.flag.flag-vn{background-position:-128px -154px}.flag.flag-py{background-position:-16px -121px}.flag.flag-br{background-position:-176px -11px}.flag.flag-ye{background-position:-224px -154px}.flag.flag-ie{background-position:0 -66px}.flag.flag-gh{background-position:-208px -44px}.flag.flag-cg{background-position:-80px -22px}.flag.flag-cu{background-position:-224px -22px}.flag.flag-hu{background-position:-224px -55px}.flag.flag-sg{background-position:-224px -121px}.flag.flag-at{background-position:-176px 0}.flag.flag-lk{background-position:-224px -77px}.flag.flag-vu{background-position:-144px -154px}.flag.flag-bo{background-position:-160px -11px}.flag.flag-jo{background-position:-208px -66px}.flag.flag-er{background-position:-208px -33px}.flag.flag-za{background-position:-256px -154px}.flag.flag-rs{background-position:-80px -121px}.flag.flag-nr{background-position:-16px -110px}.flag.flag-ls{background-position:-256px -77px}.flag.flag-jm{background-position:-192px -66px}.flag.flag-tz{background-position:-208px -143px}.flag.flag-ki{background-position:-16px -77px}.flag.flag-sj{background-position:0 -132px}.flag.flag-cz{background-position:-16px -33px}.flag.flag-pg{background-position:-128px -110px}.flag.flag-lv{background-position:-32px -88px}.flag.flag-do{background-position:-96px -33px}.flag.flag-lu{background-position:-16px -88px}.flag.flag-no{background-position:-256px -99px}.flag.flag-kw{background-position:-112px -77px}.flag.flag-mx{background-position:-96px -99px}.flag.flag-yt{background-position:-240px -154px}.flag.flag-ly{background-position:-48px -88px}.flag.flag-cy{background-position:0 -33px}.flag.flag-ph{background-position:-144px -110px}.flag.flag-my{background-position:-112px -99px}.flag.flag-sm{background-position:-48px -132px}.flag.flag-et{background-position:-240px -33px}.flag.flag-ru{background-position:-96px -121px}.flag.flag-tj{background-position:-48px -143px}.flag.flag-ai{background-position:-64px 0}.flag.flag-pl{background-position:-176px -110px}.flag.flag-kp{background-position:-64px -77px}.flag.flag-uy{background-position:-16px -154px}.flag.flag-gb{background-position:-112px -44px}.flag.flag-gs{background-position:-64px -55px}.flag.flag-kurdistan{background-position:-96px -77px}.flag.flag-rw{background-position:-112px -121px}.flag.flag-ec{background-position:-128px -33px}.flag.flag-mm{background-position:-192px -88px}.flag.flag-pa{background-position:-80px -110px}.flag.flag-wales{background-position:-160px -154px}.flag.flag-kg{background-position:-256px -66px}.flag.flag-ve{background-position:-80px -154px}.flag.flag-tk{background-position:-64px -143px}.flag.flag-ca{background-position:-16px -22px}.flag.flag-is{background-position:-128px -66px}.flag.flag-ke{background-position:-240px -66px}.flag.flag-ro{background-position:-64px -121px}.flag.flag-gq{background-position:-32px -55px}.flag.flag-pt{background-position:-256px -110px}.flag.flag-tf{background-position:-256px -132px}.flag.flag-ad{background-position:0 0}.flag.flag-sk{background-position:-16px -132px}.flag.flag-pm{background-position:-192px -110px}.flag.flag-om{background-position:-64px -110px}.flag.flag-an{background-position:-112px 0}.flag.flag-ws{background-position:-192px -154px}.flag.flag-sh{background-position:-240px -121px}.flag.flag-mp{background-position:-240px -88px}.flag.flag-gt{background-position:-80px -55px}.flag.flag-cf{background-position:-64px -22px}.flag.flag-zanzibar{background-position:0 -165px}.flag.flag-mw{background-position:-80px -99px}.flag.flag-catalonia{background-position:-32px -22px}.flag.flag-ug{background-position:-240px -143px}.flag.flag-je{background-position:-176px -66px}.flag.flag-km{background-position:-32px -77px}.flag.flag-in{background-position:-64px -66px}.flag.flag-bf{background-position:-48px -11px}.flag.flag-mc{background-position:-80px -88px}.flag.flag-sy{background-position:-192px -132px}.flag.flag-sn{background-position:-64px -132px}.flag.flag-kr{background-position:-80px -77px}.flag.flag-eu{background-position:-256px -33px}.flag.flag-bn{background-position:-144px -11px}.flag.flag-st{background-position:-144px -132px}.flag.flag-england{background-position:-192px -33px}.flag.flag-lc{background-position:-192px -77px}.flag.flag-dm{background-position:-80px -33px}.flag.flag-be{background-position:-32px -11px}.flag.flag-ni{background-position:-224px -99px}.flag.flag-ua{background-position:-224px -143px}.flag.flag-mz{background-position:-128px -99px}.flag.flag-pf{background-position:-112px -110px}.flag.flag-tn{background-position:-112px -143px}.flag.flag-ee{background-position:-144px -33px}.flag.flag-xk{background-position:-208px -154px}.flag.flag-sx{background-position:-176px -132px}.flag.flag-sd{background-position:-192px -121px}.flag.flag-gd{background-position:-128px -44px}.flag.flag-ci{background-position:-112px -22px}.flag.flag-sz{background-position:-208px -132px}.flag.flag-cl{background-position:-144px -22px}.flag.flag-fi{background-position:0 -44px}.flag.flag-ga{background-position:-96px -44px}.flag.flag-jp{background-position:-224px -66px}.flag.flag-de{background-position:-32px -33px}.flag.flag-np{background-position:0 -110px}.flag.flag-re{background-position:-48px -121px}.flag.flag-bg{background-position:-64px -11px}.flag.flag-sc{background-position:-160px -121px}.flag.flag-ng{background-position:-208px -99px}.flag.flag-qa{background-position:-32px -121px}.flag.flag-mk{background-position:-160px -88px}.flag.flag-aw{background-position:-208px 0}.flag.flag-kn{background-position:-48px -77px}.flag.flag-al{background-position:-80px 0}.flag.flag-bw{background-position:-240px -11px}.flag.flag-um{background-position:-256px -143px}.flag.flag-ky{background-position:-128px -77px}.flag.flag-tt{background-position:-160px -143px}.flag.flag-so{background-position:-80px -132px}.flag.flag-lt{background-position:0 -88px}.flag.flag-by{background-position:-256px -11px}.flag.flag-bb{background-position:0 -11px}.flag.flag-us{background-position:0 -154px}.flag.flag-md{background-position:-96px -88px}.flag.flag-ag{background-position:-48px 0}.flag.flag-hm{background-position:-160px -55px}.flag.flag-as{background-position:-160px 0}.flag.flag-eg{background-position:-160px -33px}.flag.flag-sv{background-position:-160px -132px}.flag.flag-sl{background-position:-32px -132px}.flag.flag-fk{background-position:-32px -44px}.flag.flag-am{background-position:-96px 0}.flag.flag-ck{background-position:-128px -22px}.flag.flag-tw{background-position:-192px -143px}.flag.flag-kh{background-position:0 -77px}.flag.flag-to{background-position:-128px -143px}.flag.flag-se{background-position:-208px -121px}.flag.flag-cd{background-position:-48px -22px}.flag.flag-pn{background-position:-208px -110px}.flag.flag-gr{background-position:-48px -55px}.flag.flag-id{background-position:-256px -55px}.flag.flag-vc{background-position:-64px -154px}.flag.flag-somaliland{background-position:-96px -132px}.flag.flag-bi{background-position:-96px -11px}.flag.flag-pk{background-position:-160px -110px}.flag.flag-pr{background-position:-224px -110px}.flag.flag-bd{background-position:-16px -11px}.flag.flag-co{background-position:-192px -22px}.flag.flag-fm{background-position:-48px -44px}.flag.flag-bm{background-position:-128px -11px}.flag.flag-ar{background-position:-144px 0}.flag.flag-bv{background-position:-224px -11px}.flag.flag-sb{background-position:-144px -121px}.flag.flag-mq{background-position:-256px -88px}.flag.flag-eh{background-position:-176px -33px}.flag.flag-bh{background-position:-80px -11px}.flag.flag-it{background-position:-144px -66px}.flag.flag-hr{background-position:-192px -55px}.flag.flag-sa{background-position:-128px -121px}.flag.flag-mv{background-position:-64px -99px}.flag.flag-mg{background-position:-128px -88px}.flag.flag-dz{background-position:-112px -33px}.flag.flag-gg{background-position:-192px -44px}.flag.flag-gm{background-position:-256px -44px}.flag.flag-af{background-position:-32px 0}.flag.flag-li{background-position:-208px -77px}.flag.flag-sr{background-position:-112px -132px}.flag.flag-vg{background-position:-96px -154px}.flag.flag-cr{background-position:-208px -22px}.flag.flag-tc{background-position:-224px -132px}.flag.flag-ao{background-position:-128px 0}.flag.flag-ma{background-position:-64px -88px}.flag.flag-mr{background-position:0 -99px}.flag.flag-gn{background-position:0 -55px}.flag.flag-ne{background-position:-176px -99px}.flag.flag-nf{background-position:-192px -99px}.flag.flag-wf{background-position:-176px -154px}.flag.flag-hk{background-position:-144px -55px}.flag.flag-gf{background-position:-160px -44px}.flag.flag-ps{background-position:-240px -110px}.flag.flag-ic{background-position:-240px -55px}.flag.flag-cw{background-position:-256px -22px}.flag.flag-ml{background-position:-176px -88px}.flag.flag-ax{background-position:-224px 0}.flag.flag-gl{background-position:-240px -44px}.flag.flag-dj{background-position:-48px -33px}.flag.flag-cn{background-position:-176px -22px}.flag.flag-ht{background-position:-208px -55px}.flag.flag-lr{background-position:-240px -77px}.flag.flag-tg{background-position:0 -143px}.flag.flag-ba{background-position:-256px 0}.flag.flag-ge{background-position:-144px -44px}.flag.flag-bz{background-position:0 -22px}.flag.flag-au{background-position:-192px 0}.flag.flag-iq{background-position:-96px -66px}.flag.flag-cm{background-position:-160px -22px}.flag.flag-gw{background-position:-112px -55px}.flag.flag-az{background-position:-240px 0}.flag.flag-na{background-position:-144px -99px}.flag.flag-fj{background-position:-16px -44px}.flag.flag-zw{background-position:-32px -165px}.flag.flag-bs{background-position:-192px -11px}.flag.flag-il{background-position:-16px -66px}.flag.flag-nz{background-position:-48px -110px}.flag.flag-me{background-position:-112px -88px}.flag.flag-si{background-position:-256px -121px}.flag.flag-nc{background-position:-160px -99px}.flag.flag-lb{background-position:-176px -77px}.jqcs_default_select{display:none}.jqcs_select{position:relative;border:1px #b1b1b1 solid;cursor:pointer;overflow:hidden;color:#fff}.jqcs_select .jqcs_value{float:left;padding:5px 50px}.jqcs_select .jqcs_value p.jqcs_placeholder{margin:0;padding:4px 0}.jqcs_select .jqcs_arrow{position:absolute;right:0;height:100%;border-left:1px #b1b1b1 solid;background-image:url("https://cdn.shopify.com/s/files/1/0211/4148/7680/t/17/assets/arrow_down.png");background-size:75%;background-repeat:no-repeat;background-position:center center}.jqcs_select .jqcs_arrow.rotated{-webkit-transform:rotate(180deg);transform:rotate(180deg);border-left:0 !important;border-right:1px #b1b1b1 solid !important}.jqcs_options{display:none;border:1px #b1b1b1 solid;border-top:0;margin-left:5px !important}.jqcs_option{cursor:pointer;text-align:left;background:#333;margin:0 5px}.jqcs_option:hover{background-color:#f9f9f9;color:#000 !important}.currency-switcher.open ul{opacity:1;pointer-events:auto;-webkit-transform:scale(1) translateY(0);transform:scale(1) translateY(0);z-index:9999999 !important}.currency-switcher ul{width:auto;box-shadow:0 0 0 1px rgba(68,68,68,.11);box-sizing:border-box;margin:4px 0 0!important !important;opacity:0;overflow:auto;overflow-x:hidden;padding:0;pointer-events:none;position:absolute;top:100%;max-height:260px;right:0;-webkit-transform-origin:50% 0;transform-origin:50% 0;-webkit-transform:scale(.75) translateY(-21px);transform:scale(.75) translateY(-21px);transition:all 0.2s cubic-bezier(.5,0,0,1.25),opacity 0.15s ease-out;z-index:100000}.currency-switcher ul li{float:none;text-align:center;margin:0;letter-spacing:normal;text-transform:none;display:block;cursor:pointer;padding:0 0 6px;list-style:none;min-width:100%;margin-bottom:0;outline:0;padding-left:18px;padding-right:0;text-align:left;transition:all 0.2s;width:120px;border-bottom: 1px solid #eee;}.currency-switcher ul li:hover{background-color:#F6F6F6}.currency-switcher ul li span{float:none;display:inline-block;vertical-align:middle}
#snackbar{visibility:hidden;min-width:250px;background-color:#333;color:#fff;text-align:center;border-radius:2px;padding:16px;position:fixed;z-index:1000000000;margin:0 auto;top:60px;left:0;right:0;}#snackbar.show{visibility:visible;-webkit-animation:fadein 0.5s, fadeout 0.5s 5.5s;animation:fadein 0.5s, fadeout 0.5s 5.5s}@-webkit-keyframes fadein{from{top:0;opacity:0}to{top:60px;opacity:1}}@keyframes fadein{from{top:0;opacity:0}to{top:60px;opacity:1}}@-webkit-keyframes fadeout{from{top:60px;opacity:1}to{top:0;opacity:0}}@keyframes fadeout{from{top:60px;opacity:1}to{top:0;opacity:0}}
</style>
<script>
var mcEnCurr = "";
{% for currency in shop.enabled_currencies %}
    mcEnCurr += '<li data-value="{{currency.iso_code}}"><span class="flag flag-{{currency.iso_code| truncate: 2, "" | downcase }}"></span><span>&nbsp;{{currency.iso_code}}</span></li>';
{% endfor %}

var mcCtn=document.createElement('div');
mcCtn.innerHTML='<div class="currency-switcher"><div><span><span class="flag flag-{{cart.currency.iso_code | truncate: 2, "" | downcase}}"></span>&nbsp;<span id="mcCurVal">{{cart.currency.iso_code}}</span></span><ul class="mcpop">'+ mcEnCurr +'</ul></div></div>';
document.getElementsByTagName('body')[0].appendChild(mcCtn);

var currencyBtn=document.querySelectorAll('.currency-switcher > div'),currencySwitcher=document.querySelectorAll('.currency-switcher'),currencyLi=document.querySelectorAll('.currency-switcher ul li');currencyBtn.forEach(function(v){v.addEventListener('click',function(e){e.stopPropagation();toggleClass(v.parentElement,'open')})});currencyLi.forEach(function(v){v.addEventListener('click',function(){var attr=v.getAttribute('data-value'),txt=v.innerHTML;v.parentElement.parentElement.children[0].innerHTML=txt;switchCur(attr)})});document.addEventListener('click',function(e){currencySwitcher.forEach(function(v){removeClass(v,'open')})});function toggleClass(el,className){var element=el;if(element.classList){element.classList.toggle(className)}else{var classes=element.className.split(" ");var i=classes.indexOf(className);if(i>=0){classes.splice(i,1)}else{classes.push(className)}element.className=classes.join(" ")}}function removeClass(ele,cls){var reg=new RegExp('(\\s|^)'+cls+'(\\s|$)');ele.className=ele.className.replace(reg,function(match){if(match.match(/^\s.+\s$/)!==null){return ' '}else{return ''}})}
function switchCur(d){var mcURL=window.location.href;if(mcURL.indexOf("currency")>-1){console.log("currency in the URL, replace");window.location.href=mcURL.replace(/currency\=[a-zA-Z]{3}/g,'currency='+d)}else if(mcURL.indexOf("?")>-1){window.location.href=mcURL+'&currency='+d}else{window.location.href=mcURL+'?currency='+d}}
</script>
{% assign settings = shop.metafields.mc-app.settings |split: "+" %}
{% assign geo_enabled = settings[0] %}
<style>
   {{settings[1]}}*/{{shop.metafields.mc-app.popup-settings }}
</style>
<script>
{% if geo_enabled == "ENABLE" %}
var cookieExpireDays=0;
{% if shop.metafields.mc-app.overrides %}
var mcAppSettings={{shop.metafields.mc-app.overrides }};
{% else %}
var mcAppSettings= "";
{% endif %}
var defaultCurr="{{shop.currency}}"||Shopify.currency.active;

//console.log( mcAppSettings);
var conj;if(window.location.href.indexOf("?")>-1){conj="&"}else{conj="?"}function setCookie(name,value,days){var expires="";if(days){var date=new Date;date.setTime(date.getTime()+days*24*60*60*1e3);expires="; expires="+date.toUTCString()}document.cookie=name+"="+(value||"")+expires+"; path=/;SameSite=Lax"}function getCookie(name){var nameEQ=name+"=";var ca=document.cookie.split(";");for(var i=0;i<ca.length;i+=1){var c=ca[i];while(c.charAt(0)==" "){c=c.substring(1,c.length)}if(c.indexOf(nameEQ)==0){return c.substring(nameEQ.length,c.length)}}return null}if(getCookie("country-origin")===null){var xhr=new XMLHttpRequest;xhr.open("POST","https://funny-nine-toy.glitch.me/api/country");xhr.onload=function(){if(xhr.status===200){var location=JSON.parse(xhr.responseText);console.log(location);setCookie("country-origin",location.country,cookieExpireDays);if(mcAppSettings[location.country]!==undefined){console.log("it has some settings and location override present");if(mcEnCurr.indexOf(location.currency)>-1){if(window.location.href.indexOf("currency")>-1){console.log("currency in the URL, replace");var mcURL=window.location.href;window.location.href=mcURL.replace(/currency\=[a-zA-Z]{3}/g,'currency='+mcAppSettings[location.country])}else{window.location.href=window.location.href+conj+"currency="+mcAppSettings[location.country]}}}else if(location.currency!==undefined){console.log(location.currency);if(mcEnCurr.indexOf(location.currency)>-1){if(window.location.href.indexOf("currency")>-1){console.log("currency in the URL, replace");var mcURL=window.location.href;window.location.href=mcURL.replace(/currency\=[a-zA-Z]{3}/g,'currency='+location.currency)}else{window.location.href=window.location.href+conj+"currency="+location.currency}}else if(mcAppSettings["rotw"]!==undefined){window.location.href=window.location.href+conj+"currency="+mcAppSettings["rotw"]}else{mcAppSettings["rotw"];if(window.location.href.indexOf("currency")>-1){console.log("currency in the URL, replace");var mcURL=window.location.href;window.location.href=mcURL.replace(/currency\=[a-zA-Z]{3}/g,'currency='+defaultCurr)}else{console.log('this is the issue');window.location.href=window.location.href+conj+"currency="+defaultCurr}}}}else{console.log("Request failed.  Returned status of "+xhr.status)}};xhr.setRequestHeader("Content-type","application/x-www-form-urlencoded");xhr.send("shop={{shop.permanent_domain}}")}

{% assign discountOverrides = shop.metafields.mc-app.discount-overrides %}
var discountOverrides = "{{discountOverrides}}";
//console.log(discountOverrides);
if(discountOverrides!==''&&getCookie("country-origin")!==null){var discountOvrdSettings=JSON.parse('{"'+discountOverrides.replace(/\+/g," ").replace(/%5B/g,"[").replace(/%5D/g,"]").replace(/&/g,'","').replace(/=/g,'":"')+'"}');if(discountOvrdSettings[getCookie("country-origin")]!==undefined){function showDiscountMsg(m){var dcms=document.createElement('div');dcms.id='snackbar';dcms.innerText=m;document.getElementsByTagName('body')[0].appendChild(dcms);var x=document.getElementById("snackbar");x.className="show";setTimeout(function(){x.className=x.className.replace("show","")},6000)}var co=getCookie("country-origin");var dc=discountOvrdSettings[co];var dcm='discountmsg['+co+']';dcm=discountOvrdSettings[dcm];var dxhr=window.XMLHttpRequest?new XMLHttpRequest():new ActiveXObject('Microsoft.XMLHTTP');dxhr.open('GET','/discount/'+dc);dxhr.onload=function(){if(dxhr.status===200){showDiscountMsg(dcm);console.log("Discount activated!")}else{alert('Request failed.  Returned status of '+dxhr.status)}};dxhr.send()}}
{% endif %}
</script>
